<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Сканирование QR-кода</title>
</head>
<body>
<body>
<style>
    body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #f4f4f9;
    color: #004eab;
    text-align: center;
}

.container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    padding: 20px;
}

h1 {
    font-size: 1.5em;
    margin-bottom: 10px;
    margin-top: -5%
}

.animated-icon {
    font-size: 3em; /* Размер иконки */
    color: #004eab;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% {
        transform: scale(1);
        opacity: 1;
    }
    50% {
        transform: scale(1.1);
        opacity: 0.7;
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.scanner {
    position: relative;
    width: 80vw;
    height: 60vw;
    max-width: 400px;
    max-height: 300px;
    overflow: hidden;
    border-radius: 10px;
    background: #eee;
    display: flex;
    justify-content: center;
    align-items: center;
}

#preview {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.buttons {
    display: flex;
    gap: 10px;
    margin-top: 5%
}

.icon-button {
    padding: 10px;
    border: none;
    border-radius: 50%;
    background-color: #ff815b;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s, transform 0.3s;
    font-size: 1.5em;
    display: flex;
    align-items: center;
    justify-content: center;
}

.icon-button:hover {
    background-color: #e66f4e;
    transform: scale(1.1);
}

</style>
<div class="container">
    <div class="animated-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-qr-code-scan"
             viewBox="0 0 16 16">
            <path d="M0 .5A.5.5 0 0 1 .5 0h3a.5.5 0 0 1 0 1H1v2.5a.5.5 0 0 1-1 0zm12 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V1h-2.5a.5.5 0 0 1-.5-.5M.5 12a.5.5 0 0 1 .5.5V15h2.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5m15 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H15v-2.5a.5.5 0 0 1 .5-.5M4 4h1v1H4z"/>
            <path d="M7 2H2v5h5zM3 3h3v3H3zm2 8H4v1h1z"/>
            <path d="M7 9H2v5h5zm-4 1h3v3H3zm8-6h1v1h-1z"/>
            <path d="M9 2h5v5H9zm1 1v3h3V3zM8 8v2h1v1H8v1h2v-2h1v2h1v-1h2v-1h-3V8zm2 2H9V9h1zm4 2h-1v1h-2v1h3zm-4 2v-1H8v1z"/>
            <path d="M12 9h2V8h-2z"/>
        </svg>
    </div>
    <h1>Отсканируйте QR-код</h1>
    <div class="scanner">
        <video id="preview"></video>
        <div class="scan-icon"></div>
    </div>
    <div class="buttons">
        <button id="toggleFlashlight" class="icon-button">
            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-lightbulb"
                 viewBox="0 0 16 16">
                <path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a2 2 0 0 0-.453-.618A5.98 5.98 0 0 1 2 6m6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1"/>
            </svg>
        </button>
        <button id="goBack" class="icon-button">
            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor"
                 class="bi bi-arrow-left-circle-fill" viewBox="0 0 16 16">
                <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0m3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z"/>
            </svg>
        </button>
    </div>
</div>
<script src="https://unpkg.com/@zxing/library@0.18.6/umd/index.min.js"></script>
<script src="{{ url_for('static', filename='scripts.js') }}"></script>
</body>
<script src="https://unpkg.com/@zxing/library@0.18.6/umd/index.min.js"></script>
<script>
const codeReader = new ZXing.BrowserQRCodeReader();
let selectedDeviceId;
let flashlightEnabled = false;

document.addEventListener('DOMContentLoaded', () => {
    codeReader.listVideoInputDevices()
        .then(videoInputDevices => {
            selectedDeviceId = videoInputDevices[0].deviceId;
            return codeReader.decodeFromVideoDevice(selectedDeviceId, 'preview', (result, err) => {
                if (result) {
                    window.location.href = result.text;
                }
                if (err && !(err instanceof ZXing.NotFoundException)) {
                    console.error(err);
                }
            });
        })
        .catch(err => console.error(err));

    document.getElementById('toggleFlashlight').addEventListener('click', () => {
        const track = codeReader.getVideoInputDevices().then(devices => {
            const track = devices[0].getTracks()[0];
            const capabilities = track.getCapabilities();

            if (capabilities.torch) {
                flashlightEnabled = !flashlightEnabled;
                track.applyConstraints({
                    advanced: [{ torch: flashlightEnabled }]
                });
            } else {
                alert('Фонарик не поддерживается на этом устройстве.');
            }
        });
    });
});








</script>
</body>
</html>
